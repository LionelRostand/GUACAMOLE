version: "2"
services:
  guacdb:
    container_name: guacdb
    hostname: guacdb
    image: mariadb:latest
    volumes:
      - guac_db_data:/var/lib/mysql
    environment:
      - MYSQL_ROOT_PASSWORD=AvousdeVoir
    expose:
      - "3306"
  guacd:
    container_name: guacd
    hostname: guacd
    image: "guacamole/guacd:latest"
    restart: always
    volumes:
      - "guacd_data:/data"
      - "guacd_conf:/conf:ro"
    expose:
      - "4822"
  guacamole:
    image: "guacamole/guacamole:latest"
    container_name: guacamole
    hostname: guacamole
    restart: always
    depends_on:
      - guacd
      - guacdb
    volumes:
      - "guac_data:/data"
      - "guac_conf:/conf:ro"
    ports:
      - "80:8084"
    links:
      - "guacdb:database"
      - "guacd:guacd"
    environment:
      - "GUACD_HOSTNAME=guacd"
      - "GUACD_PORT=4822"
      - "MYSQL_HOSTNAME=database"
      - "MYSQL_PORT=3306"
      - "MYSQL_DATABASE=guacamole"
      - "MYSQL_USER=guac"
      - "MYSQL_PASSWORD=trolololo
      - "GUACAMOLE_HOME=/data"
